{"version":3,"sources":["components/messageHistory/messageHistoryController/MessageHistory.stories.tsx","UI/AttachedFileView/IconTrash.svg","RemoteData/RemoteData.module.scss","UI/Button/Button.module.scss","App.module.scss","components/messageSender/messageSenderController/messageSenderContoller.module.scss","components/selectedMessages/SelectedHistory.module.scss","UI/Form/TextInput/TextInput.module.scss","components/messageHistory/messageHistoryView/MessageHistoryView.module.scss","RemoteData/RemoteData.component.tsx","UI/AttachedFileView/clip.png","UI/Form/FileInput/clipper.svg","components/messageSender/messageSenderView/MessageSender.module.scss","serviceWorker.ts","actions/actions.utils.ts","actions/messageSender.action.ts","reducers/utils.ts","reducers/MessageSender.reducer.ts","actions/messageHistory.action.ts","reducers/MessageHistory.reducer.ts","actions/selectedHistoryItem.action.ts","reducers/SelectedHistoryMessage.reducer.ts","reducers/index.ts","api/api.config.ts","sagas/messageSender.saga.ts","sagas/messageHistory.saga.ts","sagas/index.ts","store/index.ts","components/messageSender/messageSenderController/MessageSender.fixture.ts","UI/Form/utils.ts","UI/AttachedFileView/AttachedFileView.utils.ts","UI/AttachedFileView/AttachedFileView.tsx","UI/Form/TextInput/TextInput.model.ts","config/filesUpload.config.ts","UI/Form/FileInput/InputFile.tsx","components/messageSender/messageSenderView/MessageSender.config.ts","UI/Button/Button.tsx","UI/Form/DropZone/DropZone.utils.ts","UI/Form/DropZone/DropZone.tsx","UI/Form/TextInput/Input/Input.config.ts","UI/Form/TextInput/TextInput.utils.ts","UI/Form/TextInput/Input/Input.tsx","UI/Form/TextInput/TextArea/TextArea.tsx","components/messageSender/messageSenderView/MessageSender.view.tsx","components/messageSender/messageSenderController/MessageSender.config.ts","config/config.ts","components/messageSender/messageSenderController/MessageSender.utils.ts","components/messageSender/messageSenderController/MessageSender.controller.tsx","components/messageSender/messageSenderSuccess/messageSenderSuccess.view.tsx","containers/messageSender/MessageForm.container.tsx","containers/messageHistory/MessageHistory.container.tsx","components/selectedMessages/SelectedHistory.view.tsx","containers/selectedHistoryMessages/SelectedHistoryMessages.container.ts","App.tsx","index.tsx","UI/AttachedFileView/AttachedFileView.module.scss","UI/Form/DropZone/DropZone.module.scss","utils/utils.ts","components/messageHistory/messageHistoryController/MessageHistory.model.ts","components/messageHistory/messageHistoryView/MessageHistory.config.ts","components/messageHistory/messageHistoryView/MessageHistory.view.tsx","components/messageHistory/messageHistoryView/MessageHistory.utils.ts","components/messageHistory/messageHistoryController/MessageHistory.utils.tsx","components/messageHistory/messageHistoryController/MessageHistory.controller.tsx","UI/Form/FileInput/InputFile.module.scss"],"names":["MessageHistoryFixture","date","theme","status","id","SelectedHistoryItemsFixture","storiesOf","module","add","errorMessage","selectedHistoryItems","loadingStatus","RemoteDataStatus","SUCCESS","getHistory","console","log","data","setBulk","items","setSelectedItem","item","deleteSelectedHistoryItem","deleteBulk","exports","RdErrorComponent","error","this","props","className","css","renderComponent","isNull","message","PureComponent","RdLoadingComponent","WithLoading","componentToRender","ComponentToRender","FAILURE","LOADING","INITIAL","rdDetectComponentToRender","children","withLoadingWrapper","Boolean","window","location","hostname","match","REQUEST","SET","SET_BULK","DELETE","DELETE_BULK","createAsyncRequestTypes","base","action","type","payload","actionWithoutPayload","resetToInitialAction","MESSAGE_FORM_TYPES","messageSenderAction","request","success","response","failure","initial","createASyncReducer","initialState","state","messageSenderReducer","MESSAGE_HISTORY_TYPES","messageHistoryAction","messageHistoryReducer","SELECTED_MESSAGES_TYPES","selectedMessagesAction","rootReducer","combineReducers","selectedHistoryItemsReducer","itemIdToDelete","filter","element","bulkItems","slice","api","Axios","create","baseURL","timeout","postMessage","actionWatcherMessageSender","postData","post","params","call","put","push","letter","subject","Math","floor","random","takeLatest","actionWatcherMessageHistory","getData","get","rootSaga","all","fork","sagaMiddleware","createSagaMiddleware","composeEnhancer","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","MAX_SYMBOLS_FOR_MESSAGE","INITIAL_TEXT_FIELD_ERROR_LIST","senderNameErrorMessage","EMPTY_STRING","senderEmailErrorMessage","recipientNameErrorMessage","recipientEmailErrorMessage","contentErrorMessage","emailTitleErrorMessage","INITIAL_STATE","senderName","senderEmail","recipientName","recipientEmail","emailTitle","attachedFiles","EMPTY_ARRAY","content","textFieldsErrors","filesErrorList","messageSymbolsLeft","toBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","fileListToAttachedFileAsync","files","a","arrFiles","Array","from","arrayWithPromises","map","filesInBase64","normalizedFiles","index","name","encoding","MAX_FILE_NAME_FOR_DISPLAY","INPUT_POSITION","UIAttachedFileView","handleDeleteFile","onDelete","fileName","fileViewer","fileInfoBlock","src","clip","alt","length","fileNameExtension","getFileFormatFromFileName","fileNameCutted","reformatFileNameForPreview","deleteBtn","onClick","deleteIcon","IconTrash","ACCEPTED_FILE_FORMATS","FILE_ATTACH_CONFIG","multiple","UIInputFile","disabled","onChange","label","clipper","clipperIcon","text","input","formFieldGrouped","classNames","formField","formField__grouped","formFieldSingle","formField__single","classname","button","button__mSize","button__submit","UIButton","setDNDConfig","onDropHandler","onDrop","acceptedFiles","DropZone","useCallback","useDropzone","getRootProps","isDragActive","dropZone","dropZoneInfoBlock","dropZoneInfoBlock__message","dropZoneInfoBlock__title","dropZoneInfoBlock__description","formLeftClassname","input_left","formRightClassname","input_right","isFieldEmpty","value","trim","EMAIL_VALIDATOR_REGEXP","isValidEmail","email","test","String","toLowerCase","UIInputField","placeholder","labelText","inputPosition","fieldName","inputClassName","formPosition","LEFT","RIGHT","detectInputPosition","formWFieldWrapper","isDefined","htmlFor","inputAndErrorWrapper","formError","UITextArea","textArea","MessageSenderView","applyForm","onDeleteFile","onInputFilesChange","onDropZoneChange","onSenderNameChange","onSenderEmailChange","onRecipientNameChange","onRecipientEmailChange","onEmailTitleChange","onLetterContentChange","messageSender","symbolsLeft","fileAttachedPreview","i","key","uploadFileBtnWrapper","fileError","sendBtnWrapper","FIELDS_ERRORS","EMPTY_FIELD","INVALID_EMAIL","INVALID_SINGLE_FILE_SIZE","INVALID_TOTAL_FILE_SIZE","INVALID_FILE_FORMAT","FILE_PARSE_ERROR","fieldsValidationRules","validator","attachedFilesValidationRules","checkSingleFileSize","fileSizesPerFile","some","fileSize","MAX_FILE_SIZE_IN_MB","checkTotalFilesSize","attachedFilesSizeTotal","reduce","prev","current","checkFileFormat","filesFormats","fileFormat","indexOf","getErrorMessageFromValidator","rule","getOneErrorMessageFromErrorList","messages","MessageSenderController","sendMessage","isFieldsvalid","attaches","sendwhen","mca","setState","validateTextFieldFields","fieldsError","field","Object","keys","every","handleFieldChange","e","target","symbolsInCurrentMessage","handleFilesAdd","fileList","filesSizePerFile","size","event","updatedFileList","loadingWrapper","successMessage","MessageSenderSuccessContainer","MessageSenderSuccessView","reset","MessageSenderContainer","connect","dispatch","MessageHistoryContainer","selectedItem","MessageHistoryController","SelectedHistoryView","dataItem","selectedItemWrapper","MDASH","SelectedMessagesContainer","App","background","contentWrapper","Component","store","createStore","applyMiddleware","run","configureStore","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","variable","fileNameArray","split","SORT_FIELD","statusClassNameError","tdStatus","tdStatus_error","statusClassNameSuccess","tdStatus_success","statusClassNameInProgress","tdStatus_inprogress","arrowUp","style","color","fontSize","arrowDown","MessageHistoryView","sortByTheme","sortByDate","handleSelectItem","sortField","isSortOrderDesc","handleBulkUpdate","isSortedByDate","isSortedByTheme","isAllItemsSelected","historyItems","isAllHistoryItemsSelected","messageHistoryBlock","tableTitle","tableHistory","tableHead","checked","columnName","thStatus","isChecked","historyItemId","historyItem","isHistoryItemSelected","tdDate","tdTheme","title","getMessageStatus","emptyHistory","sortNumAndString","b","sortDate","dateA","dateB","dateAInMS","moment","unix","dateBInMS","changeSortOrder","currentSortField","clickedSortField","sortByField","sortFunc","sort","itemA","itemB","dataUI","FIELD_THEME","isSortOrderDescModified","sortedData","FIELD_DATE"],"mappings":"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","file":"static/js/main.845419d8.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nimport { storiesOf } from '@storybook/react';\r\nimport { TMessageHistoryItem } from './MessageHistory.model';\r\nimport { MessageHistoryController } from './MessageHistory.controller';\r\nimport { RemoteDataStatus } from '../../../RemoteData/RemoteData.component';\r\n\r\nexport let MessageHistoryFixture: TMessageHistoryItem[] = [\r\n    {\r\n        date: '01.01.05',\r\n        theme: 'Тема письма, которая не поместится в эту строку, потому что там се и то',\r\n        status: -2,\r\n        id: 1\r\n    },\r\n    {\r\n        date: '01.01.06',\r\n        theme: 'Test 1',\r\n        status: 1,\r\n        id: 2\r\n    },\r\n    {\r\n        date: '01.01.07',\r\n        theme: 'Test 2',\r\n        status: -1,\r\n        id: 3\r\n    }\r\n];\r\n\r\nlet SelectedHistoryItemsFixture: TMessageHistoryItem[] = [\r\n    {\r\n        date: '01.01.07',\r\n        theme: 'Test 2',\r\n        status: -1,\r\n        id: 3\r\n    }\r\n];\r\n\r\nstoriesOf(\"Message History table\", module)\r\n    .add(\"Regular\",\r\n\r\n        () => <MessageHistoryController\r\n            errorMessage={null}\r\n            selectedHistoryItems={SelectedHistoryItemsFixture}\r\n            loadingStatus={RemoteDataStatus.SUCCESS}\r\n            getHistory={() => console.log('get history')}\r\n            data={MessageHistoryFixture}\r\n            setBulk={(items: TMessageHistoryItem[]) => {console.log('set bulk ', items)}}\r\n            setSelectedItem={(item: TMessageHistoryItem) => {console.log('setSelectedItem ' ,item)}}\r\n            deleteSelectedHistoryItem={(id: number) => {console.log('deleteSelectedHistoryItem ' , id)}}\r\n            deleteBulk={() => console.log('delete Bulk')}\r\n        />\r\n    )\r\n    .add(\"With Empty Data\",\r\n        () => <MessageHistoryController\r\n            errorMessage={null}\r\n            selectedHistoryItems={[]}\r\n            loadingStatus={RemoteDataStatus.SUCCESS}\r\n            getHistory={() => console.log('get history')}\r\n            data={[]}\r\n            setBulk={(items: TMessageHistoryItem[]) => {console.log('set bulk ', items)}}\r\n            setSelectedItem={(item: TMessageHistoryItem) => {console.log('setSelectedItem ' ,item)}}\r\n            deleteSelectedHistoryItem={(id: number) => {console.log('deleteSelectedHistoryItem ' , id)}}\r\n            deleteBulk={() => console.log('delete Bulk')}\r\n        />\r\n    );\r\n","module.exports = __webpack_public_path__ + \"static/media/IconTrash.ba899406.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"withLoadingWrapper\":\"RemoteData_withLoadingWrapper__1rest\",\"renderComponent\":\"RemoteData_renderComponent__2ejKx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__3gpoF\",\"button__mSize\":\"Button_button__mSize__3D8MR\",\"button__submit\":\"Button_button__submit__3hvKi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"App_background__3MUKr\",\"contentWrapper\":\"App_contentWrapper__2PpQi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loadingWrapper\":\"messageSenderContoller_loadingWrapper__2p5R_\",\"successMessage\":\"messageSenderContoller_successMessage__XNv1a\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"selectedItemWrapper\":\"SelectedHistory_selectedItemWrapper__303he\",\"deleteIcon\":\"SelectedHistory_deleteIcon__3FVb4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"formWFieldWrapper\":\"TextInput_formWFieldWrapper__1wSb2\",\"label\":\"TextInput_label__27tnh\",\"input\":\"TextInput_input__3aJyw\",\"input_left\":\"TextInput_input_left__3_3YC\",\"input_right\":\"TextInput_input_right__7XzGh\",\"formError\":\"TextInput_formError__2V7KC\",\"inputAndErrorWrapper\":\"TextInput_inputAndErrorWrapper__3F2ad\",\"textArea\":\"TextInput_textArea__9-BNr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"messageHistoryBlock\":\"MessageHistoryView_messageHistoryBlock__pqDKr\",\"tableTitle\":\"MessageHistoryView_tableTitle__1bW5o\",\"tableHistory\":\"MessageHistoryView_tableHistory__3quBg\",\"emptyHistory\":\"MessageHistoryView_emptyHistory__BIXQN\",\"tableHead\":\"MessageHistoryView_tableHead__3yk5D\",\"columnName\":\"MessageHistoryView_columnName__cgFxa\",\"tdStatus\":\"MessageHistoryView_tdStatus__27ZLy\",\"tdStatus_error\":\"MessageHistoryView_tdStatus_error__2JWHy\",\"tdStatus_success\":\"MessageHistoryView_tdStatus_success__2VDuV\",\"tdStatus_inprogress\":\"MessageHistoryView_tdStatus_inprogress__hjr3Y\",\"tdTheme\":\"MessageHistoryView_tdTheme__3IXTG\",\"tdDate\":\"MessageHistoryView_tdDate__2SGsg\",\"thStatus\":\"MessageHistoryView_thStatus__3uGHA\"};","import React, { PureComponent } from 'react'\r\nimport { isNull } from '../utils/utils';\r\nimport { TNullOrError } from '../models/sharedModels';\r\nimport css from './RemoteData.module.scss';\r\n\r\nexport enum RemoteDataStatus {\r\n    INITIAL = '* INITIAL *',\r\n    LOADING = '* LOADING *',\r\n    SUCCESS = '* SUCCESS *',\r\n    FAILURE = '* FAILURE *',\r\n}\r\n\r\nclass RdErrorComponent extends PureComponent<{error: TNullOrError}> {\r\n    render() {\r\n        const {error} = this.props;\r\n        return ( <div className={css.renderComponent}>\r\n                {\r\n                    // @ts-ignore\r\n                    isNull(error) ? 'Error happened' : error.message\r\n                }\r\n            </div>\r\n            )\r\n    }\r\n}\r\nclass RdLoadingComponent extends PureComponent {\r\n    render() {\r\n        return <div className={css.renderComponent}>LOADING</div>\r\n    }\r\n}\r\n\r\ntype TWithLoadingProps = {\r\n    status: RemoteDataStatus,\r\n    error: TNullOrError\r\n    children: any\r\n}\r\n\r\nexport class WithLoading extends PureComponent<TWithLoadingProps>{\r\n    render() {\r\n        const { status, error, children } = this.props;\r\n        const componentToRender = rdDetectComponentToRender(status, children, error);\r\n        return <div className={css.withLoadingWrapper}>{componentToRender}</div>\r\n    }\r\n}\r\n\r\nfunction rdDetectComponentToRender<P>(status: RemoteDataStatus, ComponentToRender: React.ReactNode, error: TNullOrError) {\r\n    switch (status) {\r\n        case RemoteDataStatus.FAILURE:\r\n            return <RdErrorComponent error={error}/>;\r\n        case RemoteDataStatus.LOADING:\r\n            return <RdLoadingComponent/>;\r\n        case RemoteDataStatus.SUCCESS:\r\n            return ComponentToRender;\r\n        case RemoteDataStatus.INITIAL:\r\n            return ComponentToRender\r\n    }\r\n}\r\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE+SURBVHgB7ZfvcYMwDMVfNmCDMgIjeBRv0G4A3aAbMEJHoBu0G6QbkA1a65DuFIIJNlb4knf3jsNY1g//w5xgoyr4NdgF11x2Cf4Jfg/+xQNEAGPwn/L8vmdYM7UqWYepR0R1sA8+8/OzFUyrEjQr9Sj5J9cdYAhRb6hPMN8c41BIqRAih4K9kgshGtmHQpBkeF6QqRjEG6alSfYb2hn2gCxB6Mk33y/WlD009yDo6tiyX3SRthwyJ+sWCL1BNap8rkqBehhCiGIgPbYNXRGINpKsR8Zq2wsx4jrZYRDNE8ISQoMcCqFhzCF8TlBpCNKA9F2uOESlAg+DAAekfHxMIEgpPWIGIZI54pAOIUt7NwTJY/2NYhAaZikuSx+4Pll5TEe/4Q6EiTrcHvdkIptCnBbKak5KvmD6cf6Csf4BcprctqACIUgAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/clipper.72d65e82.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"formField\":\"MessageSender_formField__3adVh\",\"formField__grouped\":\"MessageSender_formField__grouped__dKdPK\",\"formField__single\":\"MessageSender_formField__single__19APp\",\"messageSender\":\"MessageSender_messageSender__1etxC\",\"fileAttachedPreview\":\"MessageSender_fileAttachedPreview__1RmUg\",\"sendBtnWrapper\":\"MessageSender_sendBtnWrapper__zmyLJ\",\"fileError\":\"MessageSender_fileError__15YJU\",\"symbolsLeft\":\"MessageSender_symbolsLeft__3-RHz\"};","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","export const REQUEST = 'REQUEST';\r\nexport const SUCCESS = 'SUCCESS';\r\nexport const FAILURE = 'FAILURE';\r\nexport const INITIAL = 'INITIAL';\r\nexport const SET = 'SET';\r\nexport const SET_BULK = 'SET_BULK';\r\nexport const DELETE = 'DELETE';\r\nexport const DELETE_BULK = 'DELETE_BULK';\r\n\r\nexport type TAsync_REQUEST_TYPE = {\r\n    REQUEST: string,\r\n    SUCCESS: string,\r\n    FAILURE: string,\r\n    INITIAL: string\r\n}\r\n\r\nexport type TSync_REQUEST_TYPE = {\r\n    SET: string,\r\n    DELETE: string,\r\n    DELETE_BULK: string,\r\n    SET_BULK: string\r\n}\r\n\r\nexport function createAsyncRequestTypes(base: string): TAsync_REQUEST_TYPE {\r\n    return {\r\n        REQUEST: `${base}_${REQUEST}`,\r\n        SUCCESS: `${base}_${SUCCESS}`,\r\n        FAILURE: `${base}_${FAILURE}`,\r\n        INITIAL: `${base}_${INITIAL}`,\r\n    }\r\n}\r\n\r\nexport function createSyncRequestTypes(base: string): TSync_REQUEST_TYPE {\r\n    return {\r\n        SET: `${base}_${SET}`,\r\n        DELETE: `${base}_${DELETE}`,\r\n        SET_BULK: `${base}_${SET_BULK}`,\r\n        DELETE_BULK: `${base}_${DELETE_BULK}`,\r\n    }\r\n}\r\n\r\nexport type TPayload = {type: string}\r\n\r\nexport type TAction<T> = {\r\n    type: string,\r\n    payload: T\r\n}\r\n\r\nexport type TActionEmpty = {\r\n    type: string\r\n}\r\n\r\nexport function action<T>(type: string, payload: T): TAction<T>  {\r\n    return {type, payload}\r\n}\r\nexport function actionWithoutPayload(type: string): TActionEmpty {\r\n    return {type}\r\n}\r\n\r\nexport function resetToInitialAction(type: string): TPayload  {\r\n    return {type}\r\n}\r\n","import {\r\n    action,\r\n    createAsyncRequestTypes,\r\n    SUCCESS,\r\n    FAILURE,\r\n    REQUEST,\r\n    INITIAL,\r\n    TAction,\r\n    resetToInitialAction,\r\n    TPayload\r\n} from './actions.utils';\r\nimport { TAttachedFile } from '../components/messageSender/messageSenderController/MessageSender.model';\r\n\r\nexport const MESSAGE_FORM_TYPES = createAsyncRequestTypes('MESSAGE_FORM');\r\n\r\n\r\nexport type TMessageSenderRequest = {\r\n    request: {\r\n        action: string,\r\n        letter: {\r\n            subject: string,\r\n            \"from.name\": string,\r\n            \"from.email\": string,\r\n            \"to.name\": string,\r\n            \"message\": {\r\n                \"text\":  string\r\n            },\r\n            attaches: TAttachedFile[],\r\n        },\r\n        sendwhen: string,\r\n        mca: string[]\r\n    }\r\n}\r\nexport type TMessageSenderError = {errorMessage: Error}\r\n\r\nexport type TMessageSenderResponse = {\r\n    \"track.id\": number\r\n}\r\n\r\nexport const messageSenderAction = {\r\n    request: (request: TMessageSenderRequest): TAction<TMessageSenderRequest> => action(MESSAGE_FORM_TYPES[REQUEST], request),\r\n    success: (response: TMessageSenderResponse): TAction<TMessageSenderResponse> => action(MESSAGE_FORM_TYPES[SUCCESS], response),\r\n    failure: (errorMessage: Error): TAction<TMessageSenderError> => action(MESSAGE_FORM_TYPES[FAILURE], {errorMessage}),\r\n    initial: (): TPayload => resetToInitialAction(MESSAGE_FORM_TYPES[INITIAL]),\r\n};\r\n\r\n","import {\r\n    FAILURE,\r\n    INITIAL,\r\n    REQUEST,\r\n    SUCCESS,\r\n    TAction,\r\n    TAsync_REQUEST_TYPE\r\n} from '../actions/actions.utils';\r\nimport { RemoteDataStatus } from '../RemoteData/RemoteData.component';\r\n\r\n\r\nexport const createASyncReducer = <S, A>(initialState: S, request: TAsync_REQUEST_TYPE) => {\r\n    return <S>(state = initialState, action: TAction<A>) => {\r\n        switch (action.type) {\r\n            case request[REQUEST]:\r\n                return {...state, loadingStatus: RemoteDataStatus.LOADING};\r\n            case request[FAILURE]:\r\n                return {...state, ...action.payload, loadingStatus: RemoteDataStatus.FAILURE};\r\n            case request[SUCCESS]:\r\n                return {...state, ...action.payload, loadingStatus: RemoteDataStatus.SUCCESS};\r\n            case request[INITIAL]:\r\n                return initialState;\r\n            default:\r\n                return state\r\n        }\r\n    }\r\n};\r\n","import { RemoteDataStatus } from '../RemoteData/RemoteData.component';\r\nimport { TNullOrError } from '../models/sharedModels';\r\nimport { MESSAGE_FORM_TYPES, TMessageSenderRequest, TMessageSenderResponse } from '../actions/messageSender.action';\r\nimport { createASyncReducer } from './utils';\r\n\r\nexport type TMessageSenderState = {\r\n    request?: TMessageSenderRequest,\r\n    response?: TMessageSenderResponse,\r\n    loadingStatus: RemoteDataStatus,\r\n    errorMessage: TNullOrError\r\n}\r\n\r\nconst initialState: TMessageSenderState = {\r\n    loadingStatus: RemoteDataStatus.INITIAL,\r\n    errorMessage: null\r\n};\r\n\r\nexport const messageSenderReducer = createASyncReducer(initialState, MESSAGE_FORM_TYPES);\r\n","import {\r\n    action, actionWithoutPayload,\r\n    createAsyncRequestTypes,\r\n    FAILURE,\r\n    INITIAL,\r\n    REQUEST,\r\n    resetToInitialAction,\r\n    SUCCESS,\r\n    TAction, TActionEmpty,\r\n    TPayload\r\n} from './actions.utils';\r\nimport { TMessageHistoryItem } from '../components/messageHistory/messageHistoryController/MessageHistory.model';\r\nexport const MESSAGE_HISTORY_TYPES = createAsyncRequestTypes('MESSAGE_HISTORY');\r\n\r\nexport type TMessageHistoryError = {errorMessage: Error}\r\nexport type TMessageHistoryResponse = {\r\n    data: TMessageHistoryItem[]\r\n}\r\n\r\nexport const messageHistoryAction = {\r\n    request: (): TActionEmpty => actionWithoutPayload(MESSAGE_HISTORY_TYPES[REQUEST]),\r\n    success: (response: TMessageHistoryResponse): TAction<TMessageHistoryResponse> => action(MESSAGE_HISTORY_TYPES[SUCCESS], response),\r\n    failure: (errorMessage: Error): TAction<TMessageHistoryError> => action(MESSAGE_HISTORY_TYPES[FAILURE], {errorMessage}),\r\n    initial: (): TPayload => resetToInitialAction(MESSAGE_HISTORY_TYPES[INITIAL]),\r\n};\r\n","import { RemoteDataStatus } from '../RemoteData/RemoteData.component';\r\nimport { createASyncReducer } from './utils';\r\nimport { TNullOrError } from '../models/sharedModels';\r\nimport { MESSAGE_HISTORY_TYPES } from '../actions/messageHistory.action';\r\nimport { TMessageHistoryItem } from '../components/messageHistory/messageHistoryController/MessageHistory.model';\r\n\r\nexport type TMessageHistoryState = {\r\n    data: TMessageHistoryItem[],\r\n    loadingStatus: RemoteDataStatus,\r\n    errorMessage: TNullOrError\r\n}\r\n\r\nconst initialState: TMessageHistoryState = {\r\n    data: [],\r\n    loadingStatus: RemoteDataStatus.SUCCESS,\r\n    errorMessage: null\r\n};\r\n\r\nexport const messageHistoryReducer = createASyncReducer(initialState, MESSAGE_HISTORY_TYPES);\r\n","import {\r\n    action,\r\n    createSyncRequestTypes,\r\n    SET,\r\n    DELETE,\r\n    TAction, TActionEmpty, DELETE_BULK, actionWithoutPayload, SET_BULK\r\n} from './actions.utils';\r\nimport { TMessageHistoryItem } from '../components/messageHistory/messageHistoryController/MessageHistory.model';\r\nimport { Tid } from '../reducers/SelectedHistoryMessage.reducer';\r\n\r\nexport const SELECTED_MESSAGES_TYPES = createSyncRequestTypes('SELECTED_MESSAGES');\r\n\r\nexport const selectedMessagesAction = {\r\n    set: (data: TMessageHistoryItem):  TAction<TMessageHistoryItem> => action(SELECTED_MESSAGES_TYPES[SET], data),\r\n    delete: (id: Tid):  TAction<Tid> => action(SELECTED_MESSAGES_TYPES[DELETE], id),\r\n    deleteBulk: ():  TActionEmpty => actionWithoutPayload(SELECTED_MESSAGES_TYPES[DELETE_BULK]),\r\n    setBulk: (items: TMessageHistoryItem[]): TAction<TMessageHistoryItem[]> => action(SELECTED_MESSAGES_TYPES[SET_BULK], items),\r\n};\r\n","import {SELECTED_MESSAGES_TYPES } from '../actions/selectedHistoryItem.action';\r\nimport { TMessageHistoryItem } from '../components/messageHistory/messageHistoryController/MessageHistory.model';\r\nimport { DELETE, DELETE_BULK, SET, SET_BULK, TAction } from '../actions/actions.utils';\r\n\r\nexport type TSelectedHistoryItemsState = {\r\n    selectedHistoryItems: TMessageHistoryItem[]\r\n}\r\n\r\nconst initialState: TSelectedHistoryItemsState = {\r\n    selectedHistoryItems: [],\r\n};\r\n\r\nexport type Tid = {id: number}\r\n\r\nexport const selectedHistoryItemsReducer = (\r\n    state = initialState, action: TAction<TMessageHistoryItem | Tid | TMessageHistoryItem[]>\r\n):TSelectedHistoryItemsState  => {\r\n    switch (action.type) {\r\n        case SELECTED_MESSAGES_TYPES[SET]:\r\n            return {\r\n                selectedHistoryItems: [...state.selectedHistoryItems, action.payload as TMessageHistoryItem]\r\n            };\r\n        case SELECTED_MESSAGES_TYPES[DELETE]:\r\n            const itemIdToDelete = action.payload as Tid;\r\n            return  {\r\n                selectedHistoryItems: state.selectedHistoryItems.filter(element => element.id !== itemIdToDelete.id)\r\n            };\r\n        case SELECTED_MESSAGES_TYPES[DELETE_BULK]:\r\n            return  {\r\n                selectedHistoryItems: []\r\n            };\r\n        case SELECTED_MESSAGES_TYPES[SET_BULK]:\r\n            const bulkItems = action.payload as TMessageHistoryItem[];\r\n            return  {\r\n                selectedHistoryItems: bulkItems.slice()\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import { combineReducers } from 'redux'\r\nimport { messageSenderReducer, TMessageSenderState } from './MessageSender.reducer';\r\nimport { messageHistoryReducer, TMessageHistoryState } from './MessageHistory.reducer';\r\nimport { selectedHistoryItemsReducer, TSelectedHistoryItemsState } from './SelectedHistoryMessage.reducer';\r\n\r\nexport type ApplicationState = {\r\n    messageSenderReducer: TMessageSenderState,\r\n    messageHistoryReducer: TMessageHistoryState,\r\n    selectedHistoryItemsReducer: TSelectedHistoryItemsState\r\n}\r\n\r\nexport const rootReducer = combineReducers<ApplicationState>({\r\n    messageSenderReducer,\r\n    messageHistoryReducer,\r\n    selectedHistoryItemsReducer\r\n});\r\n","import Axios from 'axios';\r\nexport const api = Axios.create({\r\n    baseURL: 'https://jsonplaceholder.typicode.com',\r\n    timeout: 5000,\r\n});\r\n","import { api } from '../api/api.config';\r\nimport { call, put } from 'redux-saga/effects';\r\nimport { takeLatest } from 'redux-saga/effects'\r\nimport { REQUEST, TAction } from '../actions/actions.utils';\r\nimport { MESSAGE_FORM_TYPES, messageSenderAction, TMessageSenderRequest } from '../actions/messageSender.action';\r\nimport { MessageHistoryFixture } from '../components/messageHistory/messageHistoryController/MessageHistory.stories';\r\nimport { messageHistoryAction } from '../actions/messageHistory.action';\r\n\r\nconst postData = (request: any) => api.post(`/posts`);\r\nexport function* postMessage (params: TAction<TMessageSenderRequest>) {\r\n    const {request} = params.payload;\r\n    try {\r\n        // simulate HTTP-request,\r\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n        const response = yield call(postData, request);\r\n        // add toFixture element\r\n        // simulate HTTP-response,\r\n        yield put(messageSenderAction.success({'track.id': 1}))\r\n\r\n        // Simulate request for retrieving updated data\r\n        MessageHistoryFixture.push({theme: request.letter.subject, status: 0, date: '11.10.19', id: Math.floor(Math.random() * 1000)});\r\n        yield put(messageHistoryAction.request())\r\n    } catch (e) {\r\n        yield put(messageSenderAction.failure(e))\r\n    }\r\n}\r\nexport function* actionWatcherMessageSender() {\r\n    yield takeLatest(MESSAGE_FORM_TYPES[REQUEST], postMessage);\r\n}\r\n","import { api } from '../api/api.config';\r\nimport { call, put } from 'redux-saga/effects';\r\nimport { takeLatest, } from 'redux-saga/effects'\r\nimport { REQUEST } from '../actions/actions.utils';\r\nimport { MESSAGE_HISTORY_TYPES, messageHistoryAction } from '../actions/messageHistory.action';\r\nimport { MessageHistoryFixture } from '../components/messageHistory/messageHistoryController/MessageHistory.stories';\r\n\r\nconst getData = () => api.get(`/posts`);\r\nexport function* getHistory () {\r\n    try {\r\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n        const response = yield call(getData)\r\n        // simulate success http-response\r\n        yield put(messageHistoryAction.success({data: MessageHistoryFixture}))\r\n\r\n    } catch (e) {\r\n        yield put(messageHistoryAction.failure(e))\r\n    }\r\n}\r\nexport function* actionWatcherMessageHistory() {\r\n    yield takeLatest(MESSAGE_HISTORY_TYPES[REQUEST], getHistory)\r\n}\r\n","import { fork, all } from '@redux-saga/core/effects';\r\nimport { actionWatcherMessageSender } from './messageSender.saga';\r\nimport { actionWatcherMessageHistory } from './messageHistory.saga';\r\n\r\nexport function* rootSaga() {\r\n    yield all([\r\n        fork(actionWatcherMessageSender),\r\n        fork(actionWatcherMessageHistory)\r\n    ])\r\n}\r\n","import { createStore, applyMiddleware, compose } from 'redux'\r\nimport { rootReducer } from '../reducers';\r\nimport createSagaMiddleware from 'redux-saga';\r\nimport { rootSaga } from '../sagas';\r\nconst sagaMiddleware = createSagaMiddleware();\r\n// @ts-ignore\r\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nexport function configureStore() {\r\n    const store = createStore(rootReducer, composeEnhancer(applyMiddleware(sagaMiddleware)));\r\n    sagaMiddleware.run(rootSaga);\r\n    return store\r\n}\r\n","import { EMPTY_ARRAY, EMPTY_STRING } from '../../../utils/utils';\r\nimport { TMessageSenderControllerState } from './MessageSender.model';\r\n\r\nexport const MAX_SYMBOLS_FOR_MESSAGE = 200;\r\n\r\nexport const INITIAL_FILES_ERROR_LIST = {\r\n    filesErrorList: [],\r\n};\r\n\r\nconst INITIAL_TEXT_FIELD_ERROR_LIST = {\r\n    senderNameErrorMessage: EMPTY_STRING,\r\n    senderEmailErrorMessage: EMPTY_STRING,\r\n    recipientNameErrorMessage: EMPTY_STRING,\r\n    recipientEmailErrorMessage: EMPTY_STRING,\r\n    contentErrorMessage: EMPTY_STRING,\r\n    emailTitleErrorMessage: EMPTY_STRING,\r\n};\r\n\r\nconst INITIAL_FIELDS_DATA = {\r\n    senderName: EMPTY_STRING,\r\n    senderEmail: EMPTY_STRING,\r\n    recipientName: EMPTY_STRING,\r\n    recipientEmail: EMPTY_STRING,\r\n    emailTitle: EMPTY_STRING,\r\n    attachedFiles: EMPTY_ARRAY,\r\n    content: EMPTY_STRING\r\n};\r\n\r\n\r\nexport const INITIAL_STATE: TMessageSenderControllerState = {\r\n    ...INITIAL_FIELDS_DATA,\r\n    textFieldsErrors: {...INITIAL_TEXT_FIELD_ERROR_LIST},\r\n    ...INITIAL_FILES_ERROR_LIST,\r\n    messageSymbolsLeft: MAX_SYMBOLS_FOR_MESSAGE\r\n}\r\n","export type TBase64 = string | ArrayBuffer | null;\r\nexport const toBase64 = (file: File) => new Promise<TBase64>((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n});\r\n\r\nexport const fileListToAttachedFileAsync = async (files: File[]) => {\r\n    const arrFiles = Array.from(files);\r\n    const arrayWithPromises = arrFiles.map((file: File) => toBase64(file));\r\n    const filesInBase64 = await Promise.all(arrayWithPromises); // each file in base64\r\n    const normalizedFiles = arrFiles.map((file: File, index: number) => ({\r\n        name: file.name,\r\n        content: filesInBase64[index],\r\n        encoding : \"base64\"\r\n    }));\r\n    return normalizedFiles\r\n};\r\n","import { getFileFormatFromFileName } from '../../utils/utils';\r\n\r\nconst MAX_FILE_NAME_FOR_DISPLAY = 20;\r\n\r\nexport function reformatFileNameForPreview(fileName: string) {\r\n    if (fileName.length > MAX_FILE_NAME_FOR_DISPLAY) {\r\n        const fileNameExtension = getFileFormatFromFileName(fileName);\r\n        const fileNameCutted = fileName.slice(0, MAX_FILE_NAME_FOR_DISPLAY);\r\n        return `${fileNameCutted}...${fileNameExtension}`\r\n    } else {\r\n        return fileName\r\n    }\r\n}\r\n","import React, { PureComponent } from 'react';\r\nimport css from './AttachedFileView.module.scss';\r\nimport IconTrash from './IconTrash.svg';\r\nimport clip from './clip.png';\r\nimport { reformatFileNameForPreview } from './AttachedFileView.utils';\r\n\r\ntype TUI_UploadFileProps = {\r\n    onDelete: (fileName: string) => void;\r\n    fileName: string,\r\n}\r\n\r\nexport class UIAttachedFileView extends PureComponent<TUI_UploadFileProps> {\r\n\r\n    handleDeleteFile = () => {\r\n        const {onDelete, fileName} = this.props;\r\n        onDelete(fileName)\r\n    };\r\n\r\n    render() {\r\n        const {fileName} = this.props;\r\n        return (\r\n            <div className={css.fileViewer}>\r\n                <div className={css.fileInfoBlock}>\r\n                    <img src={clip} className={css.clip} alt=\"clip\"/>\r\n                    <span className={css.fileName}>{reformatFileNameForPreview(fileName)}</span>\r\n                </div>\r\n                <div className={css.deleteBtn} onClick={this.handleDeleteFile}>\r\n                    <img className={css.deleteIcon} src={IconTrash} alt=\"delete icon\"/>\r\n                    <span>Удалить</span>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nexport type TUITextInputProps<T> = {\r\n    onChange: (e: React.ChangeEvent<T>) => void;\r\n    placeholder: string;\r\n    errorMessage?: string;\r\n    labelText?: string;\r\n    inputPosition?: INPUT_POSITION;\r\n    value: string,\r\n    fieldName: string,\r\n}\r\n\r\nexport enum INPUT_POSITION {\r\n    LEFT = '* LEFT *',\r\n    RIGHT = '* RIGHT *',\r\n}\r\n","export const ACCEPTED_FILE_FORMATS = ['png', 'jpg', 'jpeg', 'gif', 'pdf', 'doc', 'xls', 'zip', 'rar', '7zip', 'tgz'];\r\n\r\nexport const FILE_ATTACH_CONFIG = {\r\n    multiple: true\r\n};\r\n\r\n// 5e+6 = 5mb\r\nconst BYTES_IN_MB = 1e+6;\r\nexport const MAX_FILE_SIZE_IN_MB = 5;\r\nexport const MAX_FILE_SIZE_IN_B = MAX_FILE_SIZE_IN_MB * BYTES_IN_MB;\r\nexport const MAX_TOTAL_FILES_SIZE_IN_MB = 20;\r\nexport const MAX_TOTAL_FILES_SIZE_IN_B = MAX_TOTAL_FILES_SIZE_IN_MB * BYTES_IN_MB;\r\n","import React, { ChangeEvent } from 'react';\r\nimport css from './InputFile.module.scss';\r\nimport clipper from './clipper.svg';\r\nimport { FILE_ATTACH_CONFIG } from '../../../config/filesUpload.config';\r\n\r\ntype TUI_InputFileProps = {\r\n    onChange: (event: ChangeEvent<HTMLInputElement>) => void;\r\n    disabled?: boolean;\r\n}\r\n\r\nexport const UIInputFile = (props: TUI_InputFileProps) => {\r\n    const {disabled, onChange} = props;\r\n    return (\r\n\t    <label className={css.label}>\r\n            <img src={clipper} className={css.clipperIcon} alt=\"clip\"/>\r\n            <span className={css.text}>\r\n                Прикрепить файл\r\n            </span>\r\n            <input\r\n                className={css.input}\r\n                disabled={disabled}\r\n                type=\"file\"\r\n                onChange={onChange}\r\n                {...FILE_ATTACH_CONFIG}\r\n            />\r\n        </label>\r\n    )\r\n};\r\n","import classNames from 'classnames';\r\nimport css from './MessageSender.module.scss';\r\n\r\nexport const formFieldGrouped = classNames(css.formField, css.formField__grouped);\r\nexport const formFieldSingle = classNames(css.formField, css.formField__single);\r\n\r\n","import React from 'react';\r\nimport css from './Button.module.scss';\r\nimport classNames from 'classnames'\r\n\r\ntype TButtonProps = {\r\n    onClick: () => void;\r\n    text: string;\r\n    disabled?: boolean;\r\n}\r\n\r\nconst classname = classNames(css.button, css.button__mSize, css.button__submit);\r\n\r\nexport const UIButton = (props: TButtonProps) => {\r\n    const { onClick, disabled} = props;\r\n    return (\r\n        <button disabled={disabled}\r\n                className={classname}\r\n                onClick={onClick}>\r\n            {props.text}\r\n        </button>\r\n    )\r\n};\r\n","import { FILE_ATTACH_CONFIG } from '../../../config/filesUpload.config';\r\n\r\nexport const setDNDConfig = (onDropHandler: (files: File[]) => void) => {\r\n    return {\r\n        onDrop: (acceptedFiles: File[]) => {\r\n            onDropHandler(acceptedFiles)\r\n        },\r\n        ...FILE_ATTACH_CONFIG\r\n    }\r\n};\r\n","import React, { useCallback } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport css from './DropZone.module.scss';\r\nimport { setDNDConfig } from './DropZone.utils';\r\n\r\ntype TDropZoneProps = {\r\n    onDropHandler: Function;\r\n    children: JSX.Element\r\n}\r\n\r\nexport const DropZone = (props: TDropZoneProps) => {\r\n    const { onDropHandler } = props;\r\n    const onDrop = useCallback(acceptedFiles => {\r\n        onDropHandler(acceptedFiles)\r\n    }, []);\r\n    const {getRootProps, isDragActive} = useDropzone(setDNDConfig(onDrop));\r\n\r\n    return (\r\n        <div {...getRootProps({className: css.dropZone})}>\r\n            {props.children}\r\n            {isDragActive && <div className={css.dropZoneInfoBlock}>\r\n\t            <div className={css.dropZoneInfoBlock__message}>\r\n                    <div className={css.dropZoneInfoBlock__title}>\r\n                      Бросайте файлы сюда, я ловлю\r\n                    </div>\r\n                    <div className={css.dropZoneInfoBlock__description}>\r\n\t                    Мы принимаем картинки (jpg, png, gif), офисные файлы (doc, xls, pdf) и zip-архивы. Размеры файла до 5 МБ\r\n                    </div>\r\n                </div>\r\n            </div>}\r\n        </div>\r\n    );\r\n}\r\n","import classNames from 'classnames';\r\nimport css from './../TextInput.module.scss';\r\n\r\nexport const formLeftClassname = classNames(css.input, css.input_left);\r\nexport const formRightClassname = classNames(css.input, css.input_right);\r\n","import css from './TextInput.module.scss';\r\nimport { INPUT_POSITION } from './TextInput.model';\r\nimport { formLeftClassname, formRightClassname } from './Input/Input.config';\r\n\r\nexport const detectInputPosition = (formPosition?: INPUT_POSITION) => {\r\n    switch (formPosition) {\r\n        case INPUT_POSITION.LEFT:\r\n            return formLeftClassname;\r\n        case INPUT_POSITION.RIGHT:\r\n            return formRightClassname;\r\n        default:\r\n            return css.input;\r\n    }\r\n};\r\n\r\nexport const isFieldEmpty = (value: string) => value.trim().length === 0;\r\n\r\nconst EMAIL_VALIDATOR_REGEXP = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\nexport const isValidEmail = (email: string) => !EMAIL_VALIDATOR_REGEXP.test(String(email).toLowerCase());\r\n","import React from 'react';\r\nimport css from './../TextInput.module.scss';\r\n\r\nimport { TUITextInputProps } from '../TextInput.model';\r\nimport { isDefined } from '../../../../utils/utils';\r\nimport { detectInputPosition } from '../TextInput.utils';\r\n\r\nexport const UIInputField = (props: TUITextInputProps<HTMLInputElement>) => {\r\n    const {\r\n        placeholder,\r\n        errorMessage,\r\n        onChange,\r\n        labelText,\r\n        inputPosition,\r\n        fieldName,\r\n        value,\r\n    } = props;\r\n    const inputClassName = detectInputPosition(inputPosition);\r\n    return (\r\n        <div className={css.formWFieldWrapper}>\r\n            {isDefined(labelText) && <label className={css.label} htmlFor={fieldName}>{labelText}</label>}\r\n            <div className={css.inputAndErrorWrapper}>\r\n                <input type=\"text\"\r\n                       value={value}\r\n                       id={fieldName}\r\n                       onChange={onChange}\r\n                       placeholder={placeholder}\r\n                       className={inputClassName}\r\n                />\r\n                {errorMessage && <div className={css.formError}>{errorMessage}</div>}\r\n            </div>\r\n        </div>\r\n    )\r\n};\r\n","import React from 'react';\r\nimport css from './../TextInput.module.scss';\r\nimport { TUITextInputProps } from '../TextInput.model';\r\nimport { isDefined } from '../../../../utils/utils';\r\n\r\n\r\nexport const UITextArea = (props: TUITextInputProps<HTMLTextAreaElement>) => {\r\n    const {\r\n        placeholder,\r\n        errorMessage,\r\n        onChange,\r\n        labelText,\r\n        fieldName,\r\n        value,\r\n    } = props;\r\n    return (\r\n        <div className={css.formWFieldWrapper}>\r\n            {isDefined(labelText) && <label className={css.label} htmlFor={fieldName}>{labelText}</label>}\r\n            <div className={css.inputAndErrorWrapper}>\r\n                <textarea value={value} onChange={onChange} placeholder={placeholder} className={css.textArea} />\r\n                {errorMessage && <div className={css.formError}>{errorMessage}</div>}\r\n            </div>\r\n        </div>\r\n    )\r\n};\r\n","import React, { ChangeEvent, PureComponent } from 'react';\r\nimport css from './MessageSender.module.scss'\r\nimport { UIAttachedFileView } from '../../../UI/AttachedFileView/AttachedFileView';\r\nimport { UIInputFile } from '../../../UI/Form/FileInput/InputFile';\r\nimport { formFieldGrouped, formFieldSingle } from './MessageSender.config';\r\nimport { UIButton } from '../../../UI/Button/Button';\r\nimport { INPUT_POSITION } from '../../../UI/Form/TextInput/TextInput.model';\r\nimport { DropZone } from '../../../UI/Form/DropZone/DropZone';\r\nimport { TAttachedFile, TMessageSenderControllerState } from '../messageSenderController/MessageSender.model';\r\nimport { UIInputField } from '../../../UI/Form/TextInput/Input/Input';\r\nimport { UITextArea } from '../../../UI/Form/TextInput/TextArea/TextArea';\r\n\r\n\r\ntype TMessageSenderViewProps = {\r\n    data: TMessageSenderControllerState,\r\n    applyForm: () => void,\r\n    onDeleteFile: (fileName: string) => void,\r\n    onInputFilesChange: (event: ChangeEvent<HTMLInputElement>) => void,\r\n    onDropZoneChange: (files: FileList) => void,\r\n    onSenderNameChange: (event: ChangeEvent<HTMLInputElement>) => void,\r\n    onSenderEmailChange: (event: ChangeEvent<HTMLInputElement>) => void,\r\n    onRecipientNameChange: (event: ChangeEvent<HTMLInputElement>) => void,\r\n    onRecipientEmailChange: (event: ChangeEvent<HTMLInputElement>) => void,\r\n    onEmailTitleChange: (event: ChangeEvent<HTMLInputElement>) => void,\r\n    onLetterContentChange: (event: ChangeEvent<HTMLTextAreaElement>) => void\r\n}\r\n\r\nexport class MessageSenderView extends PureComponent<TMessageSenderViewProps> {\r\n    render(){\r\n        //#region destruction props\r\n        const {\r\n            data: {\r\n                senderName,\r\n                senderEmail,\r\n                recipientEmail,\r\n                recipientName,\r\n                emailTitle,\r\n                attachedFiles,\r\n                content,\r\n                filesErrorList,\r\n                textFieldsErrors: {\r\n                    senderEmailErrorMessage,\r\n                    recipientEmailErrorMessage,\r\n                },\r\n                messageSymbolsLeft\r\n            },\r\n            applyForm,\r\n            onDeleteFile,\r\n            onInputFilesChange,\r\n            onDropZoneChange,\r\n            onSenderNameChange,\r\n            onSenderEmailChange,\r\n            onRecipientNameChange,\r\n            onRecipientEmailChange,\r\n            onEmailTitleChange,\r\n            onLetterContentChange\r\n        } = this.props;\r\n        //#endregion\r\n        return (\r\n            <div className={css.messageSender}>\r\n                <h4>\r\n                    Отправлялка сообщений\r\n                </h4>\r\n                {/*TODO TO form*/}\r\n                <div>\r\n                    <DropZone\r\n                        onDropHandler={onDropZoneChange}>\r\n                    <div>\r\n                        <div className={formFieldGrouped}>\r\n                            <UIInputField\r\n                                value={senderName}\r\n                                onChange={onSenderNameChange}\r\n                                fieldName={'senderName'}\r\n                                placeholder={'Имя'}\r\n                                labelText={'От кого'}\r\n                                inputPosition={INPUT_POSITION.LEFT}\r\n                            />\r\n                            <UIInputField\r\n                                value={senderEmail}\r\n                                onChange={onSenderEmailChange}\r\n                                fieldName={'senderEmail'}\r\n                                placeholder={'Email'}\r\n                                errorMessage={senderEmailErrorMessage}\r\n                                inputPosition={INPUT_POSITION.RIGHT}\r\n                            />\r\n                        </div>\r\n                        <div className={formFieldGrouped}>\r\n                            <UIInputField\r\n                                value={recipientName}\r\n                                onChange={onRecipientNameChange}\r\n                                fieldName={'recipientName'}\r\n                                placeholder={'Имя'}\r\n                                labelText={'Кому'}\r\n                                inputPosition={INPUT_POSITION.LEFT}\r\n                            />\r\n                            <UIInputField\r\n                                value={recipientEmail}\r\n                                onChange={onRecipientEmailChange}\r\n                                fieldName={'recipientEmail'}\r\n                                placeholder={'Email'}\r\n                                errorMessage={recipientEmailErrorMessage}\r\n                                inputPosition={INPUT_POSITION.RIGHT}\r\n                            />\r\n                        </div>\r\n                        <div className={formFieldSingle}>\r\n                            <UIInputField\r\n                                value={emailTitle}\r\n                                onChange={onEmailTitleChange}\r\n                                fieldName={'title'}\r\n                                placeholder={'Тема письма'}\r\n                            />\r\n                        </div>\r\n                        <div className={formFieldSingle}>\r\n                            <UITextArea\r\n                                value={content}\r\n                                onChange={onLetterContentChange}\r\n                                fieldName={'content'}\r\n                                placeholder={'Сообщение'}\r\n                            />\r\n                            <div className={css.symbolsLeft}>Осталось <span>{messageSymbolsLeft}</span> символов</div>\r\n                        </div>\r\n                    </div>\r\n                    </DropZone>\r\n                    {attachedFiles.length > 0 && <div className={css.fileAttachedPreview}>\r\n                        {attachedFiles.map((file: TAttachedFile, i: number) => {\r\n                            return <UIAttachedFileView\r\n                                key={i}\r\n                                fileName={file.name}\r\n                                onDelete={onDeleteFile}\r\n                            />\r\n                        })}\r\n                    </div>}\r\n                    <div className={css.uploadFileBtnWrapper}>\r\n                        <UIInputFile\r\n                            onChange={onInputFilesChange}\r\n                        />\r\n                        {filesErrorList.map((error: string, i: number) => <p key={i} className={css.fileError}>{error}</p>)}\r\n                    </div>\r\n                    <div className={css.sendBtnWrapper}>\r\n                        <UIButton onClick={applyForm} text={'Отправить'}/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import {\r\n    ACCEPTED_FILE_FORMATS,\r\n    MAX_FILE_SIZE_IN_B,\r\n    MAX_FILE_SIZE_IN_MB,\r\n    MAX_TOTAL_FILES_SIZE_IN_MB\r\n} from '../../../config/filesUpload.config';\r\nimport { isFieldEmpty, isValidEmail } from '../../../UI/Form/TextInput/TextInput.utils';\r\nimport { MAX_TOTAL_FILES_SIZE } from '../../../config/config';\r\n\r\nexport const FIELDS_ERRORS = {\r\n    EMPTY_FIELD: 'Поле не может быть пустым',\r\n    INVALID_EMAIL: 'Email не валиден',\r\n    INVALID_SINGLE_FILE_SIZE: `Размер файла не должен превышать ${MAX_FILE_SIZE_IN_MB}мб`,\r\n    INVALID_TOTAL_FILE_SIZE: `Общий размер файлов не должен превышать ${MAX_TOTAL_FILES_SIZE_IN_MB}мб`,\r\n    INVALID_FILE_FORMAT: 'Недопустисый формат файлов',\r\n    FILE_PARSE_ERROR: 'Ошибка чтения файла'\r\n};\r\n\r\nexport const fieldsValidationRules = {\r\n    senderEmail: [\r\n        {\r\n            validator: isFieldEmpty,\r\n            errorMessage: FIELDS_ERRORS.EMPTY_FIELD\r\n        },\r\n        {\r\n            validator: isValidEmail,\r\n            errorMessage: FIELDS_ERRORS.INVALID_EMAIL\r\n        }],\r\n    recipientEmail: [\r\n        {\r\n            validator: isFieldEmpty,\r\n            errorMessage: FIELDS_ERRORS.EMPTY_FIELD\r\n        },\r\n        {\r\n            validator: isValidEmail,\r\n            errorMessage: FIELDS_ERRORS.INVALID_EMAIL\r\n        }],\r\n};\r\n\r\nexport const attachedFilesValidationRules = {\r\n    checkSingleFileSize: {\r\n        validator: (fileSizesPerFile: number[]) => fileSizesPerFile.some((fileSize: number) => fileSize > MAX_FILE_SIZE_IN_B),\r\n        errorMessage: FIELDS_ERRORS.INVALID_SINGLE_FILE_SIZE\r\n    },\r\n    checkTotalFilesSize: {\r\n        validator: (fileSizesPerFile: number[]) => {\r\n            const attachedFilesSizeTotal = fileSizesPerFile.reduce((prev: number, current: number) => prev + current, 0);\r\n            return fileSizesPerFile.length > 1 && attachedFilesSizeTotal > MAX_TOTAL_FILES_SIZE\r\n        },\r\n        errorMessage: FIELDS_ERRORS.INVALID_TOTAL_FILE_SIZE\r\n    },\r\n    checkFileFormat: {\r\n        validator: (filesFormats: string[]) => filesFormats.some((fileFormat: string) => ACCEPTED_FILE_FORMATS.indexOf(fileFormat) === -1),\r\n        errorMessage: FIELDS_ERRORS.INVALID_FILE_FORMAT\r\n    },\r\n};\r\n","export const ACCEPTED_FILE_FORMATS = ['png', 'jpg', 'jpeg', 'gif', 'pdf', 'doc', 'xls', 'zip', 'rar', '7zip', 'tgz'];\r\n\r\nexport const FILE_ATTACH_CONFIG = {\r\n    multiple: true,\r\n    MAX_FILE_SIZE: 5e+6,\r\n};\r\n\r\nexport const MAX_TOTAL_FILES_SIZE = 5e+6 * 4;\r\n","import { TVALIDATOR_RULE } from './MessageSender.model';\r\n\r\n\r\nexport const getErrorMessageFromValidator = <T extends unknown>(rule: TVALIDATOR_RULE<T>, data: T): string => rule.validator(data) ? rule.errorMessage : '';\r\nexport const getOneErrorMessageFromErrorList = (messages: string[]) => messages.filter(errorMessage => !!errorMessage)[0];\r\n","import React, { ChangeEvent, PureComponent } from 'react';\r\nimport { INITIAL_STATE, MAX_SYMBOLS_FOR_MESSAGE } from './MessageSender.fixture';\r\nimport { fileListToAttachedFileAsync } from '../../../UI/Form/utils';\r\nimport { getFileFormatFromFileName } from '../../../utils/utils';\r\nimport { MessageSenderView } from '../messageSenderView/MessageSender.view';\r\nimport { RemoteDataStatus, WithLoading } from '../../../RemoteData/RemoteData.component';\r\nimport {\r\n    MessageSenderSuccessContainer,\r\n} from '../../../containers/messageSender/MessageForm.container';\r\nimport { attachedFilesValidationRules, FIELDS_ERRORS, fieldsValidationRules } from './MessageSender.config';\r\nimport { getErrorMessageFromValidator, getOneErrorMessageFromErrorList } from './MessageSender.utils';\r\nimport css from './messageSenderContoller.module.scss';\r\nimport {\r\n    TAttachedFile,\r\n    TMessageSenderControllerProps,\r\n    TMessageSenderControllerState,\r\n    TStateKeys\r\n} from './MessageSender.model';\r\n\r\nexport class MessageSenderController extends PureComponent<TMessageSenderControllerProps, TMessageSenderControllerState> {\r\n    state = INITIAL_STATE;\r\n\r\n    render() {\r\n        const { loadingStatus, errorMessage} = this.props;\r\n        return (\r\n            <>\r\n                {loadingStatus === RemoteDataStatus.INITIAL ? <MessageSenderView\r\n                    data={this.state}\r\n                    applyForm={this.applyForm}\r\n                    onDeleteFile={this.onDeleteFile}\r\n                    onInputFilesChange={this.onInputFilesChange}\r\n                    onDropZoneChange={this.onDropZoneChange}\r\n                    onSenderNameChange={this.onSenderNameChange}\r\n                    onSenderEmailChange={this.onSenderEmailChange}\r\n                    onRecipientNameChange={this.onRecipientNameChange}\r\n                    onRecipientEmailChange={this.onRecipientEmailChange}\r\n                    onEmailTitleChange={this.onEmailTitleChange}\r\n                    onLetterContentChange={this.onLetterContentChange}\r\n                /> : <div className={css.loadingWrapper}>\r\n                        <div className={css.successMessage}>\r\n                            <WithLoading\r\n                                status={loadingStatus}\r\n                                error={errorMessage}>\r\n                                <MessageSenderSuccessContainer/>\r\n                            </WithLoading>\r\n                        </div>\r\n                </div>\r\n                }\r\n            </>\r\n\r\n        )\r\n    }\r\n\r\n    //#region apply form\r\n\r\n\r\n    applyForm = () => {\r\n        const {sendMessage} = this.props;\r\n        const {\r\n            senderName,\r\n            senderEmail,\r\n            recipientName,\r\n            recipientEmail,\r\n            emailTitle,\r\n            content,\r\n            attachedFiles\r\n        } = this.state;\r\n        if(this.isFieldsvalid()) {\r\n            const requestObject = {\r\n                request: {\r\n                    action: 'issue.send.test',\r\n                    letter: {\r\n                        subject: emailTitle.trim(),\r\n                        \"from.name\": senderName.trim(),\r\n                        \"from.email\": senderEmail.trim(),\r\n                        \"to.name\": recipientName.trim(),\r\n                        \"message\": {\r\n                            \"text\":  content.trim()\r\n                        },\r\n                        attaches: attachedFiles,\r\n                    },\r\n                    sendwhen: 'test',\r\n                    mca: [\r\n                        recipientEmail\r\n                    ]\r\n                }\r\n            };\r\n            sendMessage(requestObject);\r\n            this.setState({\r\n                ...INITIAL_STATE\r\n            })\r\n        }\r\n    };\r\n\r\n    //#endregion\r\n\r\n    //#region validators\r\n        validateTextFieldFields = (): boolean => {\r\n        const {\r\n            senderEmail,\r\n            recipientEmail,\r\n        } = this.state;\r\n        const fieldsError = {\r\n            senderEmailErrorMessage: getOneErrorMessageFromErrorList(fieldsValidationRules.senderEmail.map(field => getErrorMessageFromValidator(field, senderEmail))),\r\n            recipientEmailErrorMessage: getOneErrorMessageFromErrorList(fieldsValidationRules.recipientEmail.map(field => getErrorMessageFromValidator(field, recipientEmail))),\r\n        };\r\n        this.setState({\r\n            textFieldsErrors: {...fieldsError}\r\n        });\r\n        // @ts-ignore\r\n        const isValid = Object.keys(fieldsError).every((error: string) => !fieldsError[error]);\r\n        return isValid\r\n    }\r\n\r\n    isFieldsvalid = (): boolean => {\r\n        const {\r\n            filesErrorList\r\n        } = this.state;\r\n        return this.validateTextFieldFields() && !filesErrorList.length\r\n    }\r\n    //#endregion\r\n\r\n    //#region text fields change handlers\r\n\r\n    handleFieldChange = (fieldName: TStateKeys, value: string) => {\r\n        // @ts-ignore\r\n        this.setState({\r\n            [fieldName]: value\r\n        } as unknown)\r\n    };\r\n\r\n\r\n    onSenderNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.handleFieldChange('senderName', e.target.value)\r\n    };\r\n\r\n    onSenderEmailChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.handleFieldChange('senderEmail', e.target.value)\r\n    };\r\n\r\n    onRecipientNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.handleFieldChange('recipientName', e.target.value)\r\n    };\r\n\r\n    onRecipientEmailChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.handleFieldChange('recipientEmail', e.target.value)\r\n    };\r\n\r\n    onEmailTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.handleFieldChange('emailTitle', e.target.value)\r\n    };\r\n\r\n    onLetterContentChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        const symbolsInCurrentMessage = MAX_SYMBOLS_FOR_MESSAGE - e.target.value.length;\r\n        if (symbolsInCurrentMessage >= 0) {\r\n            this.setState({\r\n                content: e.target.value,\r\n                messageSymbolsLeft: symbolsInCurrentMessage\r\n            })\r\n        }\r\n    };\r\n\r\n    //#endregion\r\n\r\n    //#region files change handlers\r\n    handleFilesAdd = async (files : FileList) => {\r\n        const fileList = files as FileList;\r\n        const arrFiles = Array.from(fileList);\r\n        const filesSizePerFile = arrFiles.map((file: File) => file.size);\r\n        const filesFormats = arrFiles.map((file: File) => file.name).map(getFileFormatFromFileName);\r\n        let filesErrorList = [\r\n            getErrorMessageFromValidator(attachedFilesValidationRules.checkFileFormat, filesFormats),\r\n            getErrorMessageFromValidator(attachedFilesValidationRules.checkTotalFilesSize, filesSizePerFile),\r\n            getErrorMessageFromValidator(attachedFilesValidationRules.checkSingleFileSize, filesSizePerFile),\r\n        ].filter(errorMessage => !!errorMessage);\r\n        try {\r\n            const attachedFiles = await fileListToAttachedFileAsync(arrFiles);\r\n            if (!filesErrorList.length) {\r\n                this.setState({\r\n                    attachedFiles,\r\n                    filesErrorList: []\r\n                })\r\n            } else {\r\n                this.setState({\r\n                    filesErrorList\r\n                })\r\n            }\r\n\r\n        } catch (e) {\r\n            filesErrorList.push(FIELDS_ERRORS.FILE_PARSE_ERROR);\r\n            this.setState({\r\n                filesErrorList\r\n            })\r\n        }\r\n    };\r\n\r\n    onInputFilesChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n        this.handleFilesAdd(event.target.files as FileList)\r\n    };\r\n\r\n    onDropZoneChange = (files: FileList) => {\r\n        this.handleFilesAdd(files)\r\n    };\r\n\r\n    onDeleteFile = (fileName: string) => {\r\n        const { attachedFiles } = this.state;\r\n        const updatedFileList = attachedFiles.filter((file: TAttachedFile) => fileName !== file.name);\r\n        this.setState( {attachedFiles: updatedFileList})\r\n    };\r\n\r\n    //#endregion\r\n\r\n}\r\n","import React, { PureComponent } from 'react';\r\nimport { UIButton } from '../../../UI/Button/Button';\r\n\r\ntype TMessageSenderViewProps = {\r\n    reset: () => void\r\n}\r\n\r\nexport class MessageSenderSuccessView extends PureComponent<TMessageSenderViewProps> {\r\n    render(){\r\n        const {\r\n            reset\r\n        } = this.props;\r\n        return (\r\n            <>\r\n                <h4>\r\n                    Сообщение успешно отправлено\r\n                </h4>\r\n                <UIButton onClick={reset} text={'Отправить еще'}/>\r\n            </>\r\n        )\r\n    }\r\n}\r\n","import { Dispatch } from 'react'\r\nimport { ApplicationState } from '../../reducers';\r\nimport { TAction, TActionEmpty, TPayload } from '../../actions/actions.utils';\r\nimport { connect } from 'react-redux';\r\nimport { messageSenderAction, TMessageSenderRequest } from '../../actions/messageSender.action';\r\nimport { MessageSenderController } from '../../components/messageSender/messageSenderController/MessageSender.controller';\r\nimport { RemoteDataStatus } from '../../RemoteData/RemoteData.component';\r\nimport { TNullOrError } from '../../models/sharedModels';\r\nimport { MessageSenderSuccessView } from '../../components/messageSender/messageSenderSuccess/messageSenderSuccess.view';\r\n\r\n\r\nexport type TMessageSenderContainerProps = {\r\n    sendMessage: (request: TMessageSenderRequest) => void,\r\n    errorMessage: TNullOrError,\r\n    loadingStatus: RemoteDataStatus\r\n}\r\n\r\nconst mapStateToProps = (state: ApplicationState) => {\r\n    const { loadingStatus, errorMessage } = state.messageSenderReducer;\r\n    return { loadingStatus, errorMessage}\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<TAction<TMessageSenderRequest> | TPayload >) => ({\r\n    sendMessage: (request: TMessageSenderRequest) => dispatch(messageSenderAction.request(request)),\r\n});\r\n\r\nexport const MessageSenderContainer = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(MessageSenderController);\r\n\r\n\r\nconst mapDispatchToPropsSuccessContainer = (dispatch: Dispatch<TActionEmpty>) => ({\r\n    reset: () => dispatch(messageSenderAction.initial()),\r\n});\r\n\r\nexport const MessageSenderSuccessContainer = connect(null, mapDispatchToPropsSuccessContainer,\r\n)(MessageSenderSuccessView);\r\n","import { Dispatch } from 'react'\r\nimport { ApplicationState } from '../../reducers';\r\nimport { TAction, TActionEmpty, TPayload } from '../../actions/actions.utils';\r\nimport { connect } from 'react-redux';\r\nimport { messageHistoryAction } from '../../actions/messageHistory.action';\r\nimport { MessageHistoryController } from '../../components/messageHistory/messageHistoryController/MessageHistory.controller';\r\nimport { TNullOrError } from '../../models/sharedModels';\r\nimport { RemoteDataStatus } from '../../RemoteData/RemoteData.component';\r\nimport { selectedMessagesAction } from '../../actions/selectedHistoryItem.action';\r\nimport { TMessageHistoryItem } from '../../components/messageHistory/messageHistoryController/MessageHistory.model';\r\n\r\nexport type TMessageHistoryContainerProps = {\r\n    getHistory: () => void,\r\n    errorMessage: TNullOrError,\r\n    loadingStatus: RemoteDataStatus,\r\n    setSelectedItem: (item: TMessageHistoryItem) => void,\r\n    deleteSelectedHistoryItem: (id: number) => void,\r\n    selectedHistoryItems: TMessageHistoryItem[],\r\n    data: TMessageHistoryItem[],\r\n    deleteBulk: () => void,\r\n    setBulk: (data: TMessageHistoryItem[]) => void\r\n}\r\n\r\nconst mapStateToProps = (state: ApplicationState) => {\r\n    const { loadingStatus, errorMessage, data } = state.messageHistoryReducer;\r\n    const { selectedHistoryItems } = state.selectedHistoryItemsReducer;\r\n    return { loadingStatus, errorMessage, data, selectedHistoryItems}\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<TAction<TActionEmpty> | TPayload >) => ({\r\n    getHistory: () => dispatch(messageHistoryAction.request()),\r\n    setSelectedItem: (selectedItem: TMessageHistoryItem) => dispatch(selectedMessagesAction.set(selectedItem)),\r\n    deleteSelectedHistoryItem: (id: number) => dispatch(selectedMessagesAction.delete({id})),\r\n    deleteBulk: () => dispatch(selectedMessagesAction.deleteBulk()),\r\n    setBulk: (data: TMessageHistoryItem[]) => dispatch(selectedMessagesAction.setBulk(data)),\r\n});\r\n\r\nexport const MessageHistoryContainer = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(MessageHistoryController);\r\n","import React, { PureComponent } from 'react';\r\nimport { TMessageHistoryItem } from '../messageHistory/messageHistoryController/MessageHistory.model';\r\nimport css from './SelectedHistory.module.scss';\r\nimport IconTrash from '../../UI/AttachedFileView/IconTrash.svg';\r\nimport { MDASH } from '../../utils/utils';\r\n\r\n\r\ntype TSelectedHistoryViewProps = {\r\n    selectedHistoryItems: TMessageHistoryItem[],\r\n    deleteSelectedHistoryItem: (id: number) => void;\r\n};\r\n\r\n\r\nexport class SelectedHistoryView extends PureComponent<TSelectedHistoryViewProps> {\r\n    render() {\r\n        const {\r\n            selectedHistoryItems,\r\n            deleteSelectedHistoryItem\r\n        } = this.props;\r\n        return (\r\n            <div>\r\n                <h3>Выбранные сообщения</h3>\r\n                {selectedHistoryItems.length ? <ul>\r\n                    {selectedHistoryItems.map((dataItem: TMessageHistoryItem, index: number) => {\r\n                        return (\r\n                            <li key={index} className={css.selectedItemWrapper}>\r\n                                <b>ID: {dataItem.id}</b> {MDASH} Отправлено: {dataItem.date}\r\n                                <img\r\n                                    src={IconTrash}\r\n                                    className={css.deleteIcon}\r\n                                    onClick={() => deleteSelectedHistoryItem(dataItem.id)}\r\n                                    alt=\"delete icon\"\r\n                                />\r\n                            </li>\r\n                        )\r\n                    })}\r\n                </ul> : <p>Нет сообщений</p>\r\n                }\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n","import { Dispatch } from 'react'\r\nimport { ApplicationState } from '../../reducers';\r\nimport { TAction } from '../../actions/actions.utils';\r\nimport { connect } from 'react-redux';\r\nimport { SelectedHistoryView } from '../../components/selectedMessages/SelectedHistory.view';\r\nimport { selectedMessagesAction } from '../../actions/selectedHistoryItem.action';\r\nimport { Tid } from '../../reducers/SelectedHistoryMessage.reducer';\r\n\r\nconst mapStateToProps = (state: ApplicationState) => {\r\n    const { selectedHistoryItems } = state.selectedHistoryItemsReducer;\r\n    return { selectedHistoryItems }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<TAction<Tid>>) => ({\r\n    deleteSelectedHistoryItem: (id: number) => dispatch(selectedMessagesAction.delete({id}))\r\n});\r\n\r\nexport const SelectedMessagesContainer = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(SelectedHistoryView);\r\n","import React, { Component } from 'react';\r\nimport css from './App.module.scss';\r\n\r\n\r\nimport { MessageSenderContainer } from './containers/messageSender/MessageForm.container';\r\nimport { MessageHistoryContainer } from './containers/messageHistory/MessageHistory.container';\r\nimport { SelectedMessagesContainer } from './containers/selectedHistoryMessages/SelectedHistoryMessages.container';\r\nexport class App extends Component {\r\n  render () {\r\n\r\n    return (\r\n        <div className={css.background}>\r\n            <div className={css.contentWrapper}>\r\n                <MessageSenderContainer />\r\n                <MessageHistoryContainer />\r\n                <SelectedMessagesContainer />\r\n            </div>\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { Provider } from 'react-redux'\r\nimport { configureStore } from './store';\r\nimport App from './App';\r\n\r\n\r\nconst store = configureStore();\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App/>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fileInfoBlock\":\"AttachedFileView_fileInfoBlock__3xuMV\",\"clip\":\"AttachedFileView_clip__1-bQT\",\"fileViewer\":\"AttachedFileView_fileViewer__3iwBC\",\"deleteBtn\":\"AttachedFileView_deleteBtn__1nMap\",\"deleteIcon\":\"AttachedFileView_deleteIcon__1jXtv\",\"fileName\":\"AttachedFileView_fileName__1QIUq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropZone\":\"DropZone_dropZone__3jSrU\",\"dropZoneInfoBlock\":\"DropZone_dropZoneInfoBlock__1nf0y\",\"dropZoneInfoBlock__message\":\"DropZone_dropZoneInfoBlock__message__11mYV\",\"dropZoneInfoBlock__title\":\"DropZone_dropZoneInfoBlock__title__1KQld\",\"dropZoneInfoBlock__description\":\"DropZone_dropZoneInfoBlock__description__2kJPq\"};","export const isDefined = <T>(variable: T): boolean => typeof variable !== \"undefined\";\r\nexport const isNull = <T>(variable: T): boolean => variable === null;\r\n\r\n\r\nexport function getFileFormatFromFileName(fileName: string) {\r\n    const fileNameArray = fileName.split('.');\r\n    return fileNameArray[fileNameArray.length - 1];\r\n}\r\n\r\nexport const EMPTY_STRING = '';\r\nexport const EMPTY_ARRAY = [];\r\nexport const MDASH = '—';\r\n","export type TMessageHistoryItem = {\r\n    date: string;\r\n    theme: string;\r\n    status: number;\r\n    id: number\r\n}\r\n\r\n\r\nexport type TFIELD = 'theme' | 'date' | 'status'\r\nexport const SORT_FIELD = {\r\n    date: 'date',\r\n    status: 'status',\r\n    theme: 'theme'\r\n};\r\n\r\n\r\nexport type TMessageHistoryControllerState = {\r\n    sortField: TFIELD | string,\r\n    isSortOrderDesc: boolean,\r\n    dataUI: TMessageHistoryItem[],\r\n    data: TMessageHistoryItem[],\r\n}\r\n","import classNames from 'classnames';\r\nimport css from \"./MessageHistoryView.module.scss\";\r\n\r\nexport const statusClassNameError = classNames(css.tdStatus, css.tdStatus_error);\r\nexport const statusClassNameSuccess = classNames(css.tdStatus, css.tdStatus_success);\r\nexport const statusClassNameInProgress = classNames(css.tdStatus, css.tdStatus_inprogress);\r\n","import React, { PureComponent } from 'react';\r\nimport css from './MessageHistoryView.module.scss';\r\nimport { SORT_FIELD, TMessageHistoryItem } from '../messageHistoryController/MessageHistory.model';\r\nimport {\r\n    getMessageClassName,\r\n    getMessageStatus,\r\n    isAllHistoryItemsSelected,\r\n    isHistoryItemSelected\r\n} from './MessageHistory.utils';\r\nimport { TMessageHistoryResponse } from '../../../actions/messageHistory.action';\r\nimport { MDASH } from '../../../utils/utils';\r\n\r\n\r\nconst arrowUp = <span style={{color: '#13e613', fontSize: '18px'}}>&#x2191;</span>;\r\nconst arrowDown = <span style={{color: '#e6714e', fontSize: '18px'}}>&#x2193;</span>;\r\n\r\ntype TMessageHistoryViewProps = TMessageHistoryResponse & {\r\n    sortByTheme: () => void,\r\n    sortByDate: () => void,\r\n    handleSelectItem: (item: TMessageHistoryItem, isChecked: boolean) => void,\r\n    handleBulkUpdate: (isChecked: boolean) => void,\r\n    selectedHistoryItems: TMessageHistoryItem[],\r\n    sortField: string,\r\n    isSortOrderDesc: boolean\r\n}\r\n\r\nexport class MessageHistoryView extends PureComponent<TMessageHistoryViewProps> {\r\n    render() {\r\n        const {\r\n            data,\r\n            sortByTheme,\r\n            sortByDate,\r\n            handleSelectItem,\r\n            sortField,\r\n            isSortOrderDesc,\r\n            selectedHistoryItems,\r\n            handleBulkUpdate\r\n        } = this.props;\r\n        const isSortedByDate = sortField === SORT_FIELD.date &&  isSortOrderDesc ? arrowDown : arrowUp;\r\n        const isSortedByTheme = sortField === SORT_FIELD.theme &&  isSortOrderDesc ? arrowDown : arrowUp;\r\n        const isAllItemsSelected = isAllHistoryItemsSelected(selectedHistoryItems, data);\r\n        return (\r\n            <div className={css.messageHistoryBlock}>\r\n                <div className={css.tableTitle}>Отправленные сообщения</div>\r\n                {!!data.length && <table className={css.tableHistory}>\r\n\t\t\t\t\t\t\t    <thead className={css.tableHead}>\r\n\t\t\t\t\t\t\t    <tr>\r\n                                    <th>\r\n                                      <input\r\n\t                                    onChange={() => handleBulkUpdate(isAllItemsSelected)}\r\n\t                                    checked={isAllItemsSelected}\r\n\t                                    type=\"checkbox\"/>\r\n                                    </th>\r\n                                    <th onClick={sortByDate}><span className={css.columnName}>Дата</span> {isSortedByDate}</th>\r\n                                    <th onClick={sortByTheme}><span className={css.columnName}>Тема</span> {isSortedByTheme} </th>\r\n                                    <th className={css.thStatus}>Статуc</th>\r\n\t\t\t\t\t\t\t    </tr>\r\n\t\t\t\t\t\t\t    </thead>\r\n\t\t\t\t\t\t\t    <tbody>\r\n                  {data.map((item: TMessageHistoryItem, index: number) => {\r\n                      const isChecked = isHistoryItemSelected(selectedHistoryItems, item.id);\r\n                      return <tr key={index}>\r\n                          <td>\r\n                              <input\r\n                                  onChange={() => handleSelectItem(item, isChecked)}\r\n                                  checked={isChecked}\r\n                                  type=\"checkbox\"/>\r\n                          </td>\r\n                          <td className={css.tdDate}>{item.date}</td>\r\n                          <td className={css.tdTheme} title={item.theme}>{item.theme || MDASH}</td>\r\n                          <td className={getMessageClassName(item.status)}>{getMessageStatus(item.status)}</td>\r\n                      </tr>\r\n                  })}\r\n\t\t\t\t\t\t\t    </tbody>\r\n\t\t\t\t\t\t    </table>}\r\n                {!data.length && <div className={css.emptyHistory}>\r\n\t\t\t\t\t\t\t    Сообщения ещё не отправлялись\r\n\t\t\t\t\t\t    </div>}\r\n            </div>\r\n        )\r\n    }\r\n};\r\n","import { statusClassNameError, statusClassNameInProgress, statusClassNameSuccess } from './MessageHistory.config';\r\nimport { TMessageHistoryItem } from '../messageHistoryController/MessageHistory.model';\r\n\r\nexport const getMessageClassName = (status: number): string => {\r\n    if (status === -1) {\r\n        return statusClassNameSuccess\r\n    } else if (status > -1) {\r\n        return statusClassNameInProgress\r\n    } else {\r\n        return statusClassNameError\r\n    }\r\n};\r\n\r\nexport const getMessageStatus = (status: number): string => {\r\n    if (status === -1) {\r\n        return 'Отправлено'\r\n    } else if (status > -1) {\r\n        return 'В очереди'\r\n    } else {\r\n        return 'Ошибка'\r\n    }\r\n};\r\n\r\n\r\nexport const isHistoryItemSelected = (selectedHistoryItems: TMessageHistoryItem[], historyItemId: number): boolean => {\r\n    return selectedHistoryItems.some(historyItem => historyItem.id === historyItemId)\r\n};\r\n\r\nexport const isAllHistoryItemsSelected = (selectedHistoryItems: TMessageHistoryItem[], historyItems: TMessageHistoryItem[]): boolean => {\r\n    return selectedHistoryItems.length === historyItems.length\r\n};\r\n","import moment from 'moment';\r\nimport { TFIELD, TMessageHistoryItem } from './MessageHistory.model';\r\n\r\nexport const sortNumAndString = (a: string | number, b: string | number, isSortOrderDesc: boolean): number => {\r\n    if (a > b) return isSortOrderDesc ? 1 : -1;\r\n    if (a < b) return isSortOrderDesc ? -1 : 1;\r\n    return 0\r\n};\r\n\r\nexport const sortDate = (dateA: string, dateB: string, isSortOrderDesc: boolean) => {\r\n    const dateAInMS = moment(dateA).unix();\r\n    const dateBInMS = moment(dateB).unix();\r\n    return sortNumAndString(dateAInMS, dateBInMS, isSortOrderDesc)\r\n};\r\n\r\nexport const changeSortOrder = (currentSortField: string, clickedSortField: TFIELD, isSortOrderDesc: boolean) => {\r\n    return currentSortField === clickedSortField ? !isSortOrderDesc : !isSortOrderDesc;\r\n};\r\n\r\nexport const sortByField = (\r\n    data: TMessageHistoryItem[],\r\n    sortField: TFIELD, isSortOrderDesc: boolean,\r\n    sortFunc: (a: string | number, b: string | number, isSortOrderDesc: boolean) => number) => {\r\n    return data.slice().sort((itemA: TMessageHistoryItem, itemB: TMessageHistoryItem) => {\r\n            return sortFunc(itemA[sortField], itemB[sortField], isSortOrderDesc)\r\n        }\r\n    )\r\n};\r\n","import React, { PureComponent } from 'react';\r\nimport {\r\n    SORT_FIELD,\r\n    TFIELD,\r\n    TMessageHistoryControllerState, TMessageHistoryItem\r\n} from './MessageHistory.model';\r\nimport { MessageHistoryView } from '../messageHistoryView/MessageHistory.view';\r\nimport { changeSortOrder, sortByField, sortNumAndString, sortDate } from './MessageHistory.utils';\r\nimport { TMessageHistoryContainerProps } from '../../../containers/messageHistory/MessageHistory.container';\r\nimport { TMessageHistoryResponse } from '../../../actions/messageHistory.action';\r\nimport { WithLoading } from '../../../RemoteData/RemoteData.component';\r\n\r\n\r\nconst initialState: TMessageHistoryControllerState = {\r\n    sortField: SORT_FIELD.date,\r\n    isSortOrderDesc: false,\r\n    dataUI: [],\r\n    data:[],\r\n};\r\n\r\ntype TMessageHistoryControllerProps = TMessageHistoryContainerProps & TMessageHistoryResponse;\r\n\r\nexport class MessageHistoryController extends PureComponent<TMessageHistoryControllerProps, TMessageHistoryControllerState> {\r\n    state = initialState;\r\n\r\n    componentDidMount(): void {\r\n        const {getHistory} = this.props;\r\n        getHistory()\r\n    }\r\n\r\n\r\n    render() {\r\n        const { sortField, dataUI, isSortOrderDesc} = this.state;\r\n        const { loadingStatus, errorMessage, selectedHistoryItems } = this.props;\r\n        return (\r\n            <WithLoading error={errorMessage} status={loadingStatus}>\r\n                <MessageHistoryView\r\n                    data={dataUI}\r\n                    selectedHistoryItems={selectedHistoryItems}\r\n                    sortByTheme={this.sortByTheme}\r\n                    sortByDate={this.sortByDate}\r\n                    handleSelectItem={this.handleSelectItem}\r\n                    handleBulkUpdate={this.handleBulkUpdate}\r\n                    sortField={sortField}\r\n                    isSortOrderDesc={isSortOrderDesc}\r\n                />\r\n            </WithLoading>\r\n\r\n        )\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: TMessageHistoryControllerProps, state: TMessageHistoryControllerState) {\r\n        if (props.data !== state.data) {\r\n            return {\r\n                data: props.data,\r\n                dataUI: props.data,\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n\r\n    handleBulkUpdate = (isChecked: boolean) => {\r\n        const { setBulk, deleteBulk, data } = this.props;\r\n        if (isChecked) {\r\n            deleteBulk()\r\n        } else {\r\n            setBulk(data)\r\n        }\r\n    };\r\n\r\n    handleSelectItem = (item: TMessageHistoryItem, isChecked: boolean) => {\r\n        const { setSelectedItem, deleteSelectedHistoryItem } = this.props;\r\n        if (isChecked) {\r\n            deleteSelectedHistoryItem(item.id)\r\n        } else  {\r\n            setSelectedItem(item)\r\n        }\r\n    };\r\n\r\n    sortByTheme = () => {\r\n        const {data} = this.props;\r\n        const {sortField, isSortOrderDesc} = this.state;\r\n        // TODO rewrite fields\r\n        const FIELD_THEME = SORT_FIELD.theme as TFIELD;\r\n        const isSortOrderDescModified = changeSortOrder(sortField, FIELD_THEME, isSortOrderDesc);\r\n\r\n        const sortedData = sortByField(data, FIELD_THEME, isSortOrderDescModified, sortNumAndString);\r\n        this.setState({\r\n            dataUI: sortedData,\r\n            isSortOrderDesc: !isSortOrderDesc,\r\n            sortField: FIELD_THEME\r\n        })\r\n    };\r\n\r\n    sortByDate = () => {\r\n        const {data} = this.props;\r\n        const {isSortOrderDesc} = this.state;\r\n        // TODO rewrite fields and remove ts-ignore\r\n        const FIELD_DATE = SORT_FIELD.date as TFIELD;\r\n        // @ts-ignore\r\n        const sortedData = sortByField(data, FIELD_DATE, isSortOrderDesc, sortDate);\r\n        this.setState({\r\n            dataUI: sortedData,\r\n            isSortOrderDesc: !isSortOrderDesc,\r\n            sortField: FIELD_DATE\r\n        })\r\n    };\r\n\r\n\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"InputFile_input__1OUKf\",\"label\":\"InputFile_label__2OHwG\",\"clipperIcon\":\"InputFile_clipperIcon__pvUDk\",\"text\":\"InputFile_text__3NjkY\"};"],"sourceRoot":""}